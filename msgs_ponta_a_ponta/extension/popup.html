<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
    <title>5uv1</title>
    <style>
      /* Efeito Glitch para o t√≠tulo */
      .glitch {
        position: relative;
        font-weight: 700;
      }
      .glitch::before,
      .glitch::after {
        content: attr(data-text);
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
      }
      .glitch::before {
        left: 2px;
        text-shadow: -1px 0 #ff00c1;
        clip: rect(44px, 450px, 56px, 0);
        animation: glitch-anim-1 5s infinite linear alternate-reverse;
      }
      .glitch::after {
        left: -2px;
        text-shadow: -1px 0 #00fff9;
        clip: rect(44px, 450px, 56px, 0);
        animation: glitch-anim-2 5s infinite linear alternate-reverse;
      }
      @keyframes glitch-anim-1 {
        0% {
          clip: rect(30px, 9999px, 10px, 0);
        }
        20% {
          clip: rect(70px, 9999px, 90px, 0);
        }
        40% {
          clip: rect(20px, 9999px, 50px, 0);
        }
        60% {
          clip: rect(80px, 9999px, 10px, 0);
        }
        80% {
          clip: rect(10px, 9999px, 40px, 0);
        }
        100% {
          clip: rect(50px, 9999px, 20px, 0);
        }
      }
      @keyframes glitch-anim-2 {
        0% {
          clip: rect(10px, 9999px, 50px, 0);
        }
        20% {
          clip: rect(60px, 9999px, 20px, 0);
        }
        40% {
          clip: rect(30px, 9999px, 80px, 0);
        }
        60% {
          clip: rect(90px, 9999px, 10px, 0);
        }
        80% {
          clip: rect(20px, 9999px, 60px, 0);
        }
        100% {
          clip: rect(70px, 9999px, 30px, 0);
        }
      }
      .logo-img {
        width: 64px;
        height: 64px;
        margin-bottom: 10px;
        border-radius: 12px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- VIEW 1: LOGIN (Integrado ao Dashboard) -->
      <div id="view-login" class="view-section active">
        <div class="login-header">
          <img src="icons/icon-128.png" alt="5uv1 Logo" class="logo-img" />
          <p class="login-subtitle">Fa√ßa login com sua conta</p>
        </div>

        <div
          style="display: flex; flex-direction: column; gap: 12px; width: 100%"
        >
          <div class="input-group">
            <span class="input-icon">üë§</span>
            <input
              type="text"
              id="login-username"
              placeholder="Usu√°rio"
              class="input-with-icon"
            />
          </div>
          <div class="input-group">
            <span class="input-icon">üîí</span>
            <input
              type="password"
              id="login-password"
              placeholder="Senha"
              class="input-with-icon"
            />
          </div>
        </div>

        <button
          id="btn-login"
          style="
            margin-top: 20px;
            width: 100%;
            padding: 12px;
            border-radius: 24px;
          "
        >
          Entrar
        </button>
        <div
          style="margin-top: 20px; font-size: 13px; color: var(--text-muted)"
        >
          N√£o tem conta?
          <a
            href="#"
            id="link-go-signup"
            style="
              color: var(--primary);
              text-decoration: none;
              font-weight: 600;
            "
            >Criar conta</a
          >
        </div>
        <div id="login-error" class="error-msg"></div>
      </div>

      <!-- VIEW 1.5: SIGNUP (Nova tela) -->
      <div id="view-signup" class="view-section signup-content">
        <div class="login-header">
          <h2 class="signup-title">Criar Conta</h2>
          <p class="login-subtitle">Junte-se ao 5uv1</p>
        </div>

        <div style="display: flex; flex-direction: column; gap: 12px">
          <div class="input-group">
            <span class="input-icon">üë§</span>
            <input
              type="text"
              id="signup-name"
              placeholder="Nome Completo"
              class="input-with-icon"
            />
          </div>

          <div class="input-group">
            <span class="input-icon">üÜî</span>
            <input
              type="text"
              id="signup-username"
              placeholder="Usu√°rio"
              class="input-with-icon"
            />
          </div>

          <div class="input-group">
            <span class="input-icon">üìß</span>
            <input
              type="email"
              id="signup-email"
              placeholder="E-mail"
              class="input-with-icon"
            />
          </div>

          <div class="input-group">
            <span class="input-icon">üîí</span>
            <input
              type="password"
              id="signup-password"
              placeholder="Senha"
              class="input-with-icon input-with-icon-right"
            />
            <span id="toggle-signup-pass" class="password-toggle-btn">üëÅÔ∏è</span>
          </div>

          <div id="password-strength-bar" class="strength-meter"></div>

          <div class="input-group">
            <span class="input-icon">üîê</span>
            <input
              type="password"
              id="signup-confirm-password"
              placeholder="Confirmar Senha"
              class="input-with-icon"
            />
          </div>
        </div>

        <div class="terms-checkbox-container">
          <input type="checkbox" id="signup-terms" class="terms-checkbox" />
          <label for="signup-terms" style="cursor: pointer"
            >Li e aceito os
            <a
              href="#"
              id="link-terms"
              style="
                color: var(--primary);
                text-decoration: none;
                font-weight: 600;
              "
              >Termos de Uso</a
            ></label
          >
        </div>

        <button
          id="btn-signup"
          style="
            margin-top: 20px;
            width: 100%;
            padding: 12px;
            border-radius: 24px;
            font-weight: 600;
          "
        >
          Cadastrar
        </button>
        <div
          style="
            margin-top: 20px;
            font-size: 13px;
            text-align: center;
            color: var(--text-muted);
          "
        >
          J√° tem conta?
          <a
            href="#"
            id="link-go-login"
            style="
              color: var(--primary);
              text-decoration: none;
              font-weight: 600;
            "
            >Fazer Login</a
          >
        </div>
        <div
          id="signup-error"
          class="error-msg"
          style="text-align: center"
        ></div>
        <div
          id="signup-success"
          class="error-msg"
          style="color: var(--success); display: none; text-align: center"
        ></div>
      </div>

      <!-- VIEW 1.6: VERIFY CODE (Nova tela) -->
      <div id="view-verify" class="view-section signup-content">
        <div class="login-header">
          <h2 class="signup-title">Verifica√ß√£o</h2>
          <p class="login-subtitle">Digite o c√≥digo enviado ao seu e-mail</p>
        </div>

        <div style="display: flex; flex-direction: column; gap: 12px">
          <div class="input-group">
            <span class="input-icon">üìß</span>
            <input
              type="email"
              id="verify-email"
              placeholder="Seu E-mail"
              class="input-with-icon"
            />
          </div>
          <div class="input-group">
            <span class="input-icon"></span>
            <input
              type="text"
              id="verify-code"
              placeholder="C√≥digo de 6 d√≠gitos"
              class="input-with-icon"
              maxlength="6"
              style="text-align: center; letter-spacing: 4px; font-weight: bold"
            />
          </div>
        </div>

        <button
          id="btn-verify"
          style="
            margin-top: 20px;
            width: 100%;
            padding: 12px;
            border-radius: 24px;
            font-weight: 600;
          "
        >
          Verificar
        </button>

        <div style="margin-top: 20px; font-size: 13px; text-align: center">
          <a
            href="#"
            id="link-back-login"
            style="color: var(--text-muted); text-decoration: none"
            >Voltar para Login</a
          >
        </div>

        <div
          id="verify-error"
          class="error-msg"
          style="text-align: center"
        ></div>
        <div
          id="verify-success"
          class="error-msg"
          style="color: var(--success); display: none; text-align: center"
        ></div>
      </div>

      <!-- VIEW 2: LISTA DE SERVIDORES -->
      <div id="view-servers" class="view-section">
        <div class="header-row">
          <div class="header-actions">
            <button id="btn-open-settings" class="btn-secondary btn-sm">
              ‚öôÔ∏è
            </button>
            <button id="btn-logout" class="btn-danger btn-xs">Sair</button>
          </div>
          <h3>Servidores Dispon√≠veis</h3>
        </div>
        <div id="user-welcome" class="user-welcome"></div>

        <div id="servers-list-container" class="servers-list-container">
          <!-- Servidores injetados via JS -->
          <div class="loading-placeholder">Carregando servidores...</div>
        </div>

        <button id="btn-refresh-servers" class="btn-secondary mt-10">
          Atualizar Lista
        </button>
      </div>

      <!-- VIEW 3: CHAT -->
      <div id="view-chat" class="view-section">
        <!-- Chat Header Group -->
        <div class="chat-header">
          <div class="status-bar">
            <span
              >Status:
              <span
                id="connection-status"
                class="status-indicator status-offline"
                >Desconectado</span
              ></span
            >
            <div class="status-actions">
              <button id="btn-reconnect" class="btn-reconnect-sm">
                Reconectar
              </button>
              <button
                id="btn-disconnect"
                class="btn-secondary btn-disconnect-sm"
              >
                Desconectar
              </button>
            </div>
          </div>
          <div class="my-id-box" id="my-id-display" title="Clique para copiar">
            ID: Carregando...
          </div>
          <!-- Crypto Box moved here -->
          <div class="crypto-box crypto-header-box">
            <span id="crypto-status" class="crypto-status-text"
              >Chaves n√£o geradas</span
            >
            <div class="crypto-actions">
              <button id="btn-gen-keys" class="btn-crypto-sm">Gerar</button
              ><button id="btn-exchange-keys" class="btn-crypto-sm" disabled>
                Trocar
              </button>
            </div>
          </div>
          <input
            type="text"
            id="target-id"
            placeholder="ID do Destinat√°rio"
            class="input-target-id"
          />
        </div>

        <div class="messages-box" id="messages-list">
          <!-- Mensagens aparecer√£o aqui -->
        </div>

        <!-- Chat Footer Group -->
        <div class="chat-footer">
          <div id="typing-indicator" class="typing-indicator-footer"></div>

          <!-- Preview Bars (Reply/Edit) -->
          <div id="reply-preview-bar" class="reply-preview-bar-footer">
            <div class="reply-sender" id="reply-preview-sender">Sender</div>
            <div class="reply-text" id="reply-preview-text">Text</div>
            <button id="btn-cancel-reply" class="btn-close-preview">√ó</button>
          </div>

          <div id="edit-preview-bar" class="edit-preview-bar-footer">
            <div class="edit-label">Editando mensagem...</div>
            <button id="btn-cancel-edit" class="btn-close-preview">√ó</button>
          </div>

          <div class="chat-input-area">
            <div id="emoji-picker" class="emoji-picker"></div>
            <button id="btn-emoji" class="btn-secondary btn-emoji">üòä</button>
            <textarea
              id="message-input"
              rows="2"
              placeholder="Digite sua mensagem..."
              class="message-input"
            ></textarea>
            <button id="btn-send" class="btn-send">
              <svg
                viewBox="0 0 24 24"
                width="24"
                height="24"
                fill="currentColor"
              >
                <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"></path>
              </svg>
            </button>
          </div>
        </div>
      </div>

      <!-- VIEW 4: CONFIGURA√á√ïES -->
      <div id="view-settings" class="view-section">
        <h3>‚öôÔ∏è Configura√ß√µes</h3>

        <label for="setting-theme" class="settings-label">Tema</label>
        <div id="theme-selector" class="theme-selector">
          <button type="button" class="theme-btn" data-value="light">
            <span class="theme-icon">‚òÄÔ∏è</span>
            <span>Claro</span>
          </button>
          <button type="button" class="theme-btn" data-value="dark">
            <span class="theme-icon">üåô</span>
            <span>Escuro</span>
          </button>
        </div>

        <hr class="settings-hr" />

        <label for="setting-my-nickname" class="settings-label-sm"
          >Meu Apelido P√∫blico</label
        >
        <input
          type="text"
          id="setting-my-nickname"
          placeholder="Como os outros ver√£o voc√™ (ex: Alice)"
          maxlength="20"
        />
        <p class="settings-desc">
          Este nome ser√° enviado criptografado apenas para quem voc√™ conectar. O
          servidor n√£o ter√° acesso.
        </p>

        <hr class="settings-hr" />

        <div class="checkbox-row">
          <input
            type="checkbox"
            id="setting-use-fixed-id"
            class="checkbox-input"
          />
          <label for="setting-use-fixed-id" class="checkbox-label"
            >Usar Username como ID Fixo</label
          >
        </div>
        <p
          class="settings-desc-bottom"
          style="color: var(--danger); margin-bottom: 15px"
        >
          ‚ö†Ô∏è <strong>Aten√ß√£o:</strong> Isso torna seu ID previs√≠vel. Qualquer
          pessoa que saiba seu usu√°rio poder√° tentar conectar-se com ele.
        </p>

        <div class="checkbox-row">
          <input
            type="checkbox"
            id="setting-clear-exit"
            class="checkbox-input"
          />
          <label for="setting-clear-exit" class="checkbox-label"
            >Limpar hist√≥rico ao fechar</label
          >
        </div>
        <p class="settings-desc-bottom">
          Se ativado, o hist√≥rico de conversas ser√° apagado sempre que a
          extens√£o for aberta.
        </p>

        <div class="checkbox-row mb-10">
          <input
            type="checkbox"
            id="setting-notifications"
            class="checkbox-input"
            checked
          />
          <label for="setting-notifications" class="checkbox-label"
            >Receber notifica√ß√µes de novas mensagens</label
          >
        </div>

        <div class="checkbox-row mb-10">
          <input
            type="checkbox"
            id="setting-sounds"
            class="checkbox-input"
            checked
          />
          <label for="setting-sounds" class="checkbox-label"
            >Reproduzir sons</label
          >
        </div>

        <div class="checkbox-row mb-10">
          <input
            type="checkbox"
            id="setting-auto-reconnect"
            class="checkbox-input"
            checked
          />
          <label for="setting-auto-reconnect" class="checkbox-label"
            >Reconectar automaticamente</label
          >
        </div>

        <button id="btn-clear-history" class="btn-danger">
          üóëÔ∏è Limpar Hist√≥rico de Chats
        </button>

        <hr class="settings-hr" />

        <button id="btn-save-settings">Salvar</button>
        <button id="btn-cancel-settings" class="btn-secondary">Cancelar</button>
      </div>
    </div>

    <!-- Scripts: Ordem importa -->
    <script src="crypto-handler.js"></script>
    <script src="signup.js"></script>
    <script src="popup.js"></script>
  </body>
</html>
